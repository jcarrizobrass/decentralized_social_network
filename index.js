  var el = function(id){ return document.querySelector(id); };
  var ipfs = new IPFS({ host: 'ipfs.infura.io', protocol: 'https' });

  var postphotourl = "";

    if (false)
          {
              web3 = new Web3(web3.currentProvider);
          } else {
              // set the provider you want from Web3.providers
              web3 = new Web3(new Web3.providers.HttpProvider("http://localhost:8545"));   

          }
    
    web3.eth.defaultAccount = web3.eth.accounts[0];
    accounts =  web3.eth.accounts;
    accounts.forEach(function(address){
          bidAccount.innerHTML += '<option value="' + address + '">'
            + address + '</option>';
          bidAccounter.innerHTML += '<option value="' + address + '">'
            + address + '</option>';
    });

    function tocopy(){$('#bidacc').val($('#bidAccount').val()); }
    function tocopy1(){$('#bidacc').val($('#bidAccounter').val()); }

var SocialContract = web3.eth.contract([{"constant":true,"inputs":[],"name":"OwnerIs","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"addressu","type":"address"}],"name":"getlenPublishUser","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"addressu","type":"address"},{"name":"index","type":"uint256"}],"name":"getPublishUser","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"useradd","type":"address"}],"name":"getUserContract","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"useradd","type":"address"},{"name":"publishadd","type":"address"}],"name":"CreatePublish","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"Users","outputs":[{"name":"Useradd","type":"address"},{"name":"counter","type":"uint256"},{"name":"exists","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"useradd","type":"address"}],"name":"getUsercount","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"debug_gas_sc","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"sc_owner","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"user","type":"address"},{"name":"contractuser","type":"address"}],"name":"CreateUser","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"addressf","type":"address"}],"name":"AddFriendsS","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"inputs":[],"payable":true,"stateMutability":"payable","type":"constructor"}]);
  $("#startNET").on('click', function (){
   socialcore = SocialContract.new(
    {
      from: $('#bidAccount').val(), 
      data: '0x6080604052336000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505a600181905550610d6c8061005a6000396000f3006080604052600436106100af576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff1680631073776f146100b45780631c0d51b71461010b57806348c084df146101625780637e6c75f2146101ef5780639093a9fd1461027257806399b956a0146102d55780639bb1c3991461036a578063e02469f6146103c1578063e18efa28146103ec578063e8611f1b14610443578063ea9624e9146104a6575b600080fd5b3480156100c057600080fd5b506100c96104e9565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34801561011757600080fd5b5061014c600480360381019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050610512565b6040518082815260200191505060405180910390f35b34801561016e57600080fd5b506101ad600480360381019080803573ffffffffffffffffffffffffffffffffffffffff16906020019092919080359060200190929190505050610561565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b3480156101fb57600080fd5b50610230600480360381019080803573ffffffffffffffffffffffffffffffffffffffff1690602001909291905050506105e5565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34801561027e57600080fd5b506102d3600480360381019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050610651565b005b3480156102e157600080fd5b50610316600480360381019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050610833565b604051808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200183815260200182151515158152602001935050505060405180910390f35b34801561037657600080fd5b506103ab600480360381019080803573ffffffffffffffffffffffffffffffffffffffff16906020019092919050505061088a565b6040518082815260200191505060405180910390f35b3480156103cd57600080fd5b506103d66108d6565b6040518082815260200191505060405180910390f35b3480156103f857600080fd5b506104016108dc565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34801561044f57600080fd5b506104a4600480360381019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050610901565b005b3480156104b257600080fd5b506104e7600480360381019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050610a8c565b005b60008060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b6000600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600101805490509050919050565b6000600260008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600101828154811015156105b257fe5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905092915050565b6000600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff169050919050565b60011515600260008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060020160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff161515141515156106f157600080fd5b600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206001018190806001815401808255809150509060018203906000526020600020016000909192909190916101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550506001600260008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060020160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff0219169083151502179055505050565b60026020528060005260406000206000915090508060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16908060030154908060040160009054906101000a900460ff16905083565b6000600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600301549050919050565b60015481565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b60011515600260008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060040160009054906101000a900460ff1615151415151561096457600080fd5b80600260008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506001600260008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600301819055506001600260008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060040160006101000a81548160ff0219169083151502179055505050565b60011515600260003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663a8b8be02836040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001915050602060405180830381600087803b158015610b8d57600080fd5b505af1158015610ba1573d6000803e3d6000fd5b505050506040513d6020811015610bb757600080fd5b8101908080519060200190929190505050151514151515610bd757600080fd5b600260003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16636a2c0360826040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001915050600060405180830381600087803b158015610cd457600080fd5b505af1158015610ce8573d6000803e3d6000fd5b505050506001600260003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060030160008282540192505081905550505600a165627a7a723058201a23e0f6a28f5b8ec0b02d09650b306618bb17bf9806444c1cfc4c757db97a3e0029', 
      gas: '4700000'
    }, function (e, contract){
      console.log(e, contract);
      if (typeof contract.address !== 'undefined') {
          $('#score').val(contract.address);
          console.log('Contract mined! address: ' + contract.address + ' transactionHash: ' + contract.transactionHash);
      }
  });
  });



  $("#buttonFriend").on('click' ,function() {

      socialcore.AddFriendsS.sendTransaction($("#Friend").val(),{
            from: $('#bidacc').val(),
            gas:4000000},function (error, result){ 
                if(!error){
                    console.log(result);
                } else{
                    console.log(error);
                }
        });
              
          });
  
  


var userContract = web3.eth.contract([{"constant":true,"inputs":[],"name":"name","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"index","type":"uint256"}],"name":"getUserFriends","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"getName","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"addressf","type":"address"}],"name":"AddFriends","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"Friends","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"owner","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"ishere","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"addressf","type":"address"}],"name":"FExists","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"inputs":[{"name":"name1","type":"string"},{"name":"ipfs_hash1","type":"string"},{"name":"Score","type":"address"}],"payable":true,"stateMutability":"payable","type":"constructor"}]); 
$("#buttonUser").on('click' ,function() {
              var user = userContract.new(
                $("#name").val(),
                 $("#ipfshash").val(),
                socialcore.address,
              {
                from: $('#bidacc').val(), 
                data: '0x6080604052604051610a14380380610a1483398101806040528101908080518201929190602001805182019291906020018051906020019092919050505033600360006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508260019080519060200190610094929190610273565b5081600290805190602001906100ab929190610273565b5060016000806101000a81548160ff0219169083151502179055508073ffffffffffffffffffffffffffffffffffffffff1663e8611f1b33306040518363ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200192505050600060405180830381600087803b15801561019557600080fd5b505af11580156101a9573d6000803e3d6000fd5b5050505060043390806001815401808255809150509060018203906000526020600020016000909192909190916101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550506001600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff021916908315150217905550505050610318565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106102b457805160ff19168380011785556102e2565b828001600101855582156102e2579182015b828111156102e15782518255916020019190600101906102c6565b5b5090506102ef91906102f3565b5090565b61031591905b808211156103115760008160009055506001016102f9565b5090565b90565b6106ed806103276000396000f30060806040526004361061008e576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806306fdde03146100935780630a018df01461012357806317d7de7c146101905780636a2c0360146102205780638a1a8bbf146102635780638da5cb5b146102d0578063a050bdd614610327578063a8b8be0214610356575b600080fd5b34801561009f57600080fd5b506100a86103b1565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156100e85780820151818401526020810190506100cd565b50505050905090810190601f1680156101155780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34801561012f57600080fd5b5061014e6004803603810190808035906020019092919050505061044f565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34801561019c57600080fd5b506101a5610492565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156101e55780820151818401526020810190506101ca565b50505050905090810190601f1680156102125780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34801561022c57600080fd5b50610261600480360381019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050610534565b005b34801561026f57600080fd5b5061028e600480360381019080803590602001909291905050506105f5565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b3480156102dc57600080fd5b506102e5610633565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34801561033357600080fd5b5061033c610659565b604051808215151515815260200191505060405180910390f35b34801561036257600080fd5b50610397600480360381019080803573ffffffffffffffffffffffffffffffffffffffff16906020019092919050505061066b565b604051808215151515815260200191505060405180910390f35b60018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156104475780601f1061041c57610100808354040283529160200191610447565b820191906000526020600020905b81548152906001019060200180831161042a57829003601f168201915b505050505081565b600060048281548110151561046057fe5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff169050919050565b606060018054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561052a5780601f106104ff5761010080835404028352916020019161052a565b820191906000526020600020905b81548152906001019060200180831161050d57829003601f168201915b5050505050905090565b60048190806001815401808255809150509060018203906000526020600020016000909192909190916101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550506001600560008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff02191690831515021790555050565b60048181548110151561060457fe5b906000526020600020016000915054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b6000809054906101000a900460ff1681565b6000600560008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff1690509190505600a165627a7a72305820d2bf248e8f9426a4b0f6e69711224599f0abd959ee3bb9d53b7c6799eb778daf0029', 
                gas: '4700000'
              }, function (e, contract){
                console.log(e, contract);
                if (typeof contract.address !== 'undefined') {
                  console.log(socialcore.address);
                    console.log('Contract mined! address: ' + contract.address + ' transactionHash: ' + contract.transactionHash);
                }
            })
            
        });

var publishContract = web3.eth.contract([{"constant":true,"inputs":[],"name":"shares","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[],"name":"shareEvent","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"getBNS","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[],"name":"UserCollect","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"get_min_inf","outputs":[{"name":"","type":"uint256[2]"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"gas_ammount_to_stop","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"getIPFS","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"Influencers","outputs":[{"name":"top5","type":"bool"},{"name":"shared","type":"bool"},{"name":"followers","type":"uint256"},{"name":"collected","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"Pammount_","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"BNS","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[],"name":"Finish","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"collected","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[],"name":"AuthorStopCollect","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"gas_ammount_to_end","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"owner","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"EffortPayment","outputs":[{"name":"","type":"uint256[2]"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"addressu","type":"address"}],"name":"getContent","outputs":[{"name":"","type":"string"},{"name":"","type":"bool"},{"name":"","type":"bool"},{"name":"","type":"bool"},{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"debug_gas","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"finished","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"ammount_","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"inputs":[{"name":"ipfs_content1","type":"string"},{"name":"socialcore","type":"address"}],"payable":true,"stateMutability":"payable","type":"constructor"}]);
 $("#buttonPublish").on('click' ,function() {
  var create_post_hash = {"message":$('#publisher').val(),"image":postphotourl};
  var post_hash = JSON.stringify(create_post_hash);
    ipfs.addJSON(post_hash, (err, result) => {
        if (err) {
            console.log('Hmm.. there was an error: ' + String(err));
        } else {

            var publish = publishContract.new(
            result,
            $('#score').val(),
            {
                from: $('#bidacc').val(), 
                data: '0x608060405260405162001f4038038062001f40833981018060405281019080805182019291906020018051906020019092919050505080600360006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16631073776f6040518163ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401602060405180830381600087803b158015620000fd57600080fd5b505af115801562000112573d6000803e3d6000fd5b505050506040513d60208110156200012957600080fd5b8101908080519060200190929190505050600460006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555033600b60006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555034600a819055505a600f819055508160029080519060200190620001e19291906200035c565b506000600760006101000a81548160ff0219169083151502179055506000600d8190555060006005819055506000600681905550600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16639093a9fd600b60009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16306040518363ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200192505050600060405180830381600087803b1580156200032957600080fd5b505af11580156200033e573d6000803e3d6000fd5b505050506002600c81620003539190620003e3565b5050506200043a565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106200039f57805160ff1916838001178555620003d0565b82800160010185558215620003d0579182015b82811115620003cf578251825591602001919060010190620003b2565b5b509050620003df919062000412565b5090565b8154818355818111156200040d578183600052602060002091820191016200040c919062000412565b5b505050565b6200043791905b808211156200043357600081600090555060010162000419565b5090565b90565b611af6806200044a6000396000f300608060405260043610610112576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806303314efa146101175780630a550245146101425780631a9737af146101595780631fe763831461018457806320d200f51461019b5780632b333acd146101ee5780634efe2d1e14610219578063540a3e27146102a95780636c5eff261461032157806370ff726b1461036257806374a82f69146103cf57806384bcefd4146103e657806385eeb275146104115780638d6d27b3146104285780638da5cb5b14610453578063a8fb07c3146104aa578063b30ab349146104fd578063b857c5b9146105e5578063bef4876b14610610578063c6f5c4f61461063f575b600080fd5b34801561012357600080fd5b5061012c61066a565b6040518082815260200191505060405180910390f35b34801561014e57600080fd5b50610157610670565b005b34801561016557600080fd5b5061016e610bcf565b6040518082815260200191505060405180910390f35b34801561019057600080fd5b50610199610bdc565b005b3480156101a757600080fd5b506101b0610eb8565b6040518082600260200280838360005b838110156101db5780820151818401526020810190506101c0565b5050505090500191505060405180910390f35b3480156101fa57600080fd5b506102036113e4565b6040518082815260200191505060405180910390f35b34801561022557600080fd5b5061022e6113ea565b6040518080602001828103825283818151815260200191508051906020019080838360005b8381101561026e578082015181840152602081019050610253565b50505050905090810190601f16801561029b5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b3480156102b557600080fd5b506102ea600480360381019080803573ffffffffffffffffffffffffffffffffffffffff16906020019092919050505061148c565b6040518085151515158152602001841515151581526020018381526020018215151515815260200194505050505060405180910390f35b34801561032d57600080fd5b5061034c600480360381019080803590602001909291905050506114e3565b6040518082815260200191505060405180910390f35b34801561036e57600080fd5b5061038d600480360381019080803590602001909291905050506114fd565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b3480156103db57600080fd5b506103e461153b565b005b3480156103f257600080fd5b506103fb611571565b6040518082815260200191505060405180910390f35b34801561041d57600080fd5b50610426611577565b005b34801561043457600080fd5b5061043d61175f565b6040518082815260200191505060405180910390f35b34801561045f57600080fd5b50610468611765565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b3480156104b657600080fd5b506104bf61178b565b6040518082600260200280838360005b838110156104ea5780820151818401526020810190506104cf565b5050505090500191505060405180910390f35b34801561050957600080fd5b5061053e600480360381019080803573ffffffffffffffffffffffffffffffffffffffff16906020019092919050505061181d565b604051808060200186151515158152602001851515151581526020018415151515815260200183151515158152602001828103825287818151815260200191508051906020019080838360005b838110156105a657808201518184015260208101905061058b565b50505050905090810190601f1680156105d35780820380516001836020036101000a031916815260200191505b50965050505050505060405180910390f35b3480156105f157600080fd5b506105fa6119d6565b6040518082815260200191505060405180910390f35b34801561061c57600080fd5b506106256119dc565b604051808215151515815260200191505060405180910390f35b34801561064b57600080fd5b506106546119ef565b6040518082815260200191505060405180910390f35b60005481565b610678611a43565b3373ffffffffffffffffffffffffffffffffffffffff16600b60009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16141515156106d557600080fd5b60011515600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160019054906101000a900460ff1615151415151561073857600080fd5b60018060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160016101000a81548160ff02191690831515021790555060016000808282540192505081905550600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16639093a9fd33306040518363ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200192505050600060405180830381600087803b15801561089357600080fd5b505af11580156108a7573d6000803e3d6000fd5b505050506108b3610eb8565b90508060006002811015156108c457fe5b6020020151600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16639bb1c399336040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001915050602060405180830381600087803b15801561098657600080fd5b505af115801561099a573d6000803e3d6000fd5b505050506040513d60208110156109b057600080fd5b81019080805190602001909291905050501180610a455750600073ffffffffffffffffffffffffffffffffffffffff16600c8260016002811015156109f157fe5b6020020151815481101515610a0257fe5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16145b15610bb757600060016000600c846001600281101515610a6157fe5b6020020151815481101515610a7257fe5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160006101000a81548160ff02191690831515021790555033600c826001600281101515610b0357fe5b6020020151815481101515610b1457fe5b9060005260206000200160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060018060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160006101000a81548160ff0219169083151502179055505b6002600054101515610bcc57610bcb61153b565b5b50565b6000600c80549050905090565b60001515600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060020160009054906101000a900460ff161515148015610c52575060011515600760009054906101000a900460ff161515145b1515610c5d57600080fd5b3373ffffffffffffffffffffffffffffffffffffffff16600460009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161415610d4357600460009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166108fc60086001600281101515610cff57fe5b01549081150290604051600060405180830381858888f19350505050158015610d2c573d6000803e3d6000fd5b506001600d60008282540192505081905550610e69565b60011515600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160009054906101000a900460ff161515141515610da557600080fd5b3373ffffffffffffffffffffffffffffffffffffffff166108fc60086000600281101515610dcf57fe5b01549081150290604051600060405180830381858888f19350505050158015610dfc573d6000803e3d6000fd5b506001600d6000828254019250508190555060018060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060020160006101000a81548160ff0219169083151502179055505b6001600c8054905001600d541415610eb657600b60009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16ff5b565b610ec0611a43565b600080610ecb611a43565b6000600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16639bb1c399600c6000815481101515610f1b57fe5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff166040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001915050602060405180830381600087803b158015610fc457600080fd5b505af1158015610fd8573d6000803e3d6000fd5b505050506040513d6020811015610fee57600080fd5b81019080805190602001909291905050509350600090505b600c805490508110156113a757600073ffffffffffffffffffffffffffffffffffffffff16600c8281548110151561103a57fe5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614156110bb578382600060028110151561109157fe5b602002018181525050808260016002811015156110aa57fe5b6020020181815250508194506113dd565b83600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16639bb1c399600c8481548110151561110957fe5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff166040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001915050602060405180830381600087803b1580156111b257600080fd5b505af11580156111c6573d6000803e3d6000fd5b505050506040513d60208110156111dc57600080fd5b8101908080519060200190929190505050108061125e5750600073ffffffffffffffffffffffffffffffffffffffff16600c8281548110151561121b57fe5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16145b1561139a57600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16639bb1c399600c838154811015156112b057fe5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff166040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001915050602060405180830381600087803b15801561135957600080fd5b505af115801561136d573d6000803e3d6000fd5b505050506040513d602081101561138357600080fd5b810190808051906020019092919050505093508092505b8080600101915050611006565b838260006002811015156113b757fe5b602002018181525050828260016002811015156113d057fe5b6020020181815250508194505b5050505090565b60055481565b606060028054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156114825780601f1061145757610100808354040283529160200191611482565b820191906000526020600020905b81548152906001019060200180831161146557829003601f168201915b5050505050905090565b60016020528060005260406000206000915090508060000160009054906101000a900460ff16908060000160019054906101000a900460ff16908060010154908060020160009054906101000a900460ff16905084565b6008816002811015156114f257fe5b016000915090505481565b600c8181548110151561150c57fe5b906000526020600020016000915054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b6001600760006101000a81548160ff02191690831515021790555061155e61178b565b600890600261156e929190611a65565b50565b600d5481565b61157f611a43565b6000600b60009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161415156115dd57600080fd5b6115e561178b565b91506000600c8054905011156116a857600190505b600c805490508110156116a757600c8181548110151561161657fe5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166108fc83600060028110151561166957fe5b60200201519081150290604051600060405180830381858888f19350505050158015611699573d6000803e3d6000fd5b5080806001019150506115fa565b5b600460009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166108fc8360016002811015156116f357fe5b60200201519081150290604051600060405180830381858888f19350505050158015611723573d6000803e3d6000fd5b50600b60009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16ff5b60065481565b600b60009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b611793611a43565b61179b611a43565b6117c06117b56117ae604b600a546119f5565b6064611a2d565b600c80549050611a2d565b8160006002811015156117cf57fe5b6020020181815250506117fa600c805490508260006002811015156117f057fe5b60200201516119f5565b600a540381600160028110151561180d57fe5b6020020181815250508091505090565b60606000806000806002600760009054906101000a900460ff16600160008973ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160009054906101000a900460ff16600160008a73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000160019054906101000a900460ff16600160008b73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060020160009054906101000a900460ff16848054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156119bc5780601f10611991576101008083540402835291602001916119bc565b820191906000526020600020905b81548152906001019060200180831161199f57829003601f168201915b505050505094509450945094509450945091939590929450565b600f5481565b600760009054906101000a900460ff1681565b600a5481565b600080831415611a085760009050611a27565b8183029050818382811515611a1957fe5b04141515611a2357fe5b8090505b92915050565b60008183811515611a3a57fe5b04905092915050565b6040805190810160405280600290602082028038833980820191505090505090565b8260028101928215611a94579160200282015b82811115611a93578251825591602001919060010190611a78565b5b509050611aa19190611aa5565b5090565b611ac791905b80821115611ac3576000816000905550600101611aab565b5090565b905600a165627a7a7230582005cb6b28be4f2029b7c2c76b95cd28bd48b159423859cf577dbfd7b71c4102660029', 
                gas: '4700000',
                value: web3.toWei($('#publisherEth').val(), 'ether')
            }, function (e, contract){
               
                if (typeof contract.address !== 'undefined') {
                    $('#Influenceid').val(contract.address);
                    console.log('Contract mined! address: ' + contract.address + ' transactionHash: ' + contract.transactionHash);
                }
            })
            console.log('published: ' + result);
            console.log('postphotourl: ' + postphotourl);
        }
  });
  postphotourl = "";
    
    });


  $('#buttonInfluence').on('click', function (){
      published=publishContract.at($('#Influenceid').val())
      published.shareEvent.sendTransaction({
            from: $('#bidacc').val(),
            gas:4000000},function (error, result){ 
                if(!error){
                    console.log(result);
                } else{
                    console.log(error);
                }
        });
  });


function influence(buttonid){
    console.log('click');
    console.log(buttonid);
    console.log(buttonid.id.substring(3));
    published=publishContract.at(buttonid.id.substring(3));
    published.shareEvent.sendTransaction({
    from: $('#bidacc').val(),
    gas:4000000},function (error, result){ 
        if(!error){
            $('#'+buttonid.id).attr("disabled", true);
            console.log(result);
        } else{
            console.log(error);
        }
    });       
};

function collectable(buttonid){
    console.log('click');
    console.log(buttonid);
    console.log(buttonid.id.substring(3));
    published=publishContract.at(buttonid.id.substring(3));
    published.UserCollect.sendTransaction({
    from: $('#bidacc').val(),
    gas:4000000},function (error, result){ 
        if(!error){
            $('#'+buttonid.id).attr("disabled", true);
            console.log(result);
        } else{
            console.log(error);
        }
    });
           
};

function Add_Friend(buttonid){
    console.log('click');
    console.log(buttonid);
    console.log(buttonid.id.substring(3));
    socialcore.AddFriendsS.sendTransaction(buttonid.id.substring(3),{
    from: $('#bidacc').val(),
    gas:4000000},function (error, result){ 
        if(!error){
            $('#'+buttonid.id).attr("disabled", true);
            console.log(result);
        } else{
            console.log(error);
        }
    });
};

var FriendsoF=[];

$('#buttonFoFUpdate').on('click', function (){
    FriendsoF=[];
    $("#friendoF").html("");
    Friends.forEach(function(friend){
        socialcore.getUsercount.call(friend.id,
        function (error1, result1){     
            if(!error1){                
                socialcore.getUserContract.call(friend.id,function (error2, result2){ 
                    if(!error2){    
                        for (i=0;i<result1.c[0];i++){
                            console.log(result2);
                            userContract.at(result2).getUserFriends.call(i,function (error3,result3){
                                if(!error3){
                                    console.log('friend address');
                                    console.log(result3);
                                    socialcore.getUserContract.call(result3, function (error4,result4){
                                        if(!error4){
                                            console.log('inside');
                                            console.log(result3);
                                            userContract.at(result4).getName.call(function (error5,result5){
                                                if(!error5){
                                                    var obj = new Object();
                                                    obj.id = result3;
                                                    obj.name = result5;
                                                    string3 = 'id_'+result3.toString();
                                                    FriendsoF.push(obj);
                                                    $("#friendoF").html($("#friendoF").html()+'<a class="dropdown-item" href="#">'+ obj.name +'</a><button id='+string3+' onclick=Add_Friend('+string3+')>Add +</button>');
                                                    
                                                }else {
                                                    console.log(error5);
                                                }
                                            });           
                                        } else {
                                            console.log(error4);
                                        }
                                    });
                                    console.log(FriendsoF);
                                } else {
                                    console.log(error3);
                                }
                            });
                        }
                        console.log(result2);
                    } else{
                         console.log(error2);
                    }
                });        
                console.log(result1);
            } else {
                console.log(error1);
            }
        });
    });
});

var Friends=[];

$('#buttonUpdate').on('click', function (){
    Friends=[];
    socialcore.getUsercount.call($('#bidacc').val(),
    function (error1, result1){ 
        if(!error1){
            $("#friendlist").html("");
            socialcore.getUserContract.call($('#bidacc').val(),function (error2, result2){ 
                if(!error2){      
                    for (i=0;i<result1.c[0];i++){
                        console.log(result2);
                        userContract.at(result2).getUserFriends.call(i,function (error3,result3){
                            if(!error3){
                                console.log('friend address');
                                console.log(result3);
                                socialcore.getUserContract.call(result3, function (error4,result4){
                                if(!error4){
                                    console.log('inside');
                                    console.log(result3);
                                    userContract.at(result4).getName.call(function (error5,result5){
                                    if(!error5){
                                        var obj = new Object();
                                        obj.id = result3;
                                        obj.name = result5;
                                        Friends.push(obj);
                                        $("#friendlist").html($("#friendlist").html()+ '<a class="dropdown-item">'+obj.name+'</a>');
                                       
                                    } else { 
                                        console.log(error5);
                                    }
                                    });        
                                } else{
                                    console.log(error4);
                                }
                                });
                                console.log(Friends);
                            } else {
                                console.log(error3);
                            }
                        });
                    }
                    console.log(result2);
                } else {
                    console.log(error2);
                }
            });
            console.log(result1);
        } else {
            console.log(error1);
        }
    });
});


var publishall=[];
$('#updatePublished').on('click',function(e,res){
    console.log('clicked');
    publishall=[];
    $("#PublishStory").html("");
    Friends.forEach(function(friend){      
        socialcore.getlenPublishUser.call(friend.id, function (e,res1){
            if(!e){
                console.log(res1.c[0]);
                for(j=0;j<res1.c[0];j++){
                    socialcore.getPublishUser.call(friend.id,j,function(e2,res2){
                        if(!e2){
                            publishContract.at(res2).getContent.call($('#bidacc').val(),function(e22,res22){
                            if(!e22){
                                    console.log(res22);
                                    ipfs.catJSON(res22[0], (err, result) => {
                                        if (err) {
                                            console.log(err);
                                        } else {                                              
                                            obj = new Object()
                                            obj.fname = friend.name;
                                            obj.ipfscontent = result;
                                            obj.collectable = res22[2];
                                            obj.already_influenced = res22[3];
                                            obj.alreadycollected = res22[4];
                                            obj.Ended = res22[1];
                                            publishall.push(obj);
                                            string2 =  'id_'+res2.toString();
                                            console.log(res22[2]);               
                                            var post = JSON.parse(result);
                                            console.log("post: " +post.message+"image: "+post.image);
                                          
                                            // var image = document.getElementById("postphotooutput"); 
                                            // image.src=post.image;        
                                            
                                            if(post.image){
                                                htmltemplate='        <div class="row  justify-content-center">  <div class="card-deck text-center justify-content-center" style="width:100%;"> <div class="card mb-12 box-shadow"> <div class="card-header"> <h4 class="my-0 font-weight-normal">'+obj.fname + '</h4> </div><img class="card-img-top" src="'+post.image+'" alt="Card image cap"> <div class="card-body"> <ul class="list-unstyled mt-3 mb-4"> <li> ' + post.message+ '</li> </ul>';
                                            }
                                            else{
                                                htmltemplate='        <div class="row  justify-content-center">  <div class="card-deck text-center justify-content-center"> <div class="card mb-12 box-shadow"> <div class="card-header"> <h4 class="my-0 font-weight-normal">'+obj.fname + '</h4> </div> <div class="card-body"> <ul class="list-unstyled mt-3 mb-4"> <li> ' + post.message+ '</li> </ul>';
                                            }
                                            
                                            if(!obj.already_influenced){
                                               htmltemplate = htmltemplate +'<button id='+string2+' class="btn btn-lg btn-block btn-outline-primary"  style="float:right" onclick="influence('+string2+')">Influence</button> </div> </div> </div></div>';
                                            } else { 
                                                console.log(obj.alreadycollected);
                                                if(obj.collectable && obj.Ended && !obj.alreadycollected){
                                                   htmltemplate = htmltemplate +'<button id='+string2+'  class="btn btn-lg btn-block btn-outline-primary"  style="float:right" onclick="collectable('+string2+')">Collect me!</button></div> </div> </div></div>';
                                                }
                                            }

                                            $("#PublishStory").html($("#PublishStory").html()+ htmltemplate);
                                        }
                                    });
                                } else {
                                    console.log(e22);
                                }
                            });
                        } else { console.log("aca2");console.log(e2);}
                    });
                }
            } else { console.log("aca1");console.log(e);}
        }); 
    }); 
    console.log(publishall);
});      
 
// IPFS
function publish_ipfs_text(input){
  var isJSON = false;
  var res;
  ipfs.add(input, (err, res) => {
  if (err) {
    console.log('Hmm.. there was an error: ' + String(err));
  } else {
    console.log('publishesdddsd: ' + res);
    
    }
  });
  console.log(res);
  return res;
  
}  




function upload() {
    const reader = new FileReader();
    reader.onloadend = function() {
    // Create the IPFS node instance
    const ipfs = IpfsApi({host: 'ipfs.infura.io', port: 5001, protocol: 'https'});
    const Buffer = window.IpfsApi().Buffer;
    const buf = Buffer.from(reader.result);
    ipfs.add(buf, (err, result) => { // Upload buffer to IPFS
        if(err) {
        console.error(err)
        return
        }
        let url = `https://ipfs.io/ipfs/${result[0].hash}`
        console.log(`Url --> ${url}`);
        document.getElementById("url").innerHTML= url;
        document.getElementById("url").href= url;
        document.getElementById("output").src = url;
    });
      };
      const photo = document.getElementById("photo");
      reader.readAsArrayBuffer(photo.files[0]); // Read Provided File
}

function uploadpostphoto() {
      const reader = new FileReader();
      reader.onloadend = function() {
        // Create the IPFS node instance
        const ipfs = IpfsApi({host: 'ipfs.infura.io', port: 5001, protocol: 'https'});
        const Buffer = window.IpfsApi().Buffer;
        const buf = Buffer.from(reader.result);
        ipfs.add(buf, (err, result) => { // Upload buffer to IPFS
          if(err) {
            console.error(err)
            return
          }
          url2 = `https://ipfs.io/ipfs/${result[0].hash}`
          console.log(`Url --> ${url2}`);
          postphotourl = url2;
          document.getElementById("url2").innerHTML= url2;
          document.getElementById("url2").href= url2;
          document.getElementById("url2").src = url2;
        })
      }
      const photo = document.getElementById("postphoto");
      reader.readAsArrayBuffer(photo.files[0]); // Read Provided File
}